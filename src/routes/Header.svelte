<script>
  import { fly, fade } from "svelte/transition";
  import { createTooltip, melt } from '@melt-ui/svelte';

  const {
    elements: { trigger, content, arrow },
    states: { open },
  } = createTooltip({
    positioning: {
      placement: 'right',
    },
    openDelay: 0,
    closeDelay: 0,
    closeOnPointerDown: true,
    forceVisible: true,
  });
  let darkMode = false;
</script>
<div class="z-20 absolute top-3 right-3">
  <button
    type="button"
    use:melt={$trigger}
    on:click={()=> darkMode = !darkMode}
    class="w-10 h-10 rounded-full text-f4 overflow-hidden flex items-center justify-center bg-black/10"
  >
    {#if !darkMode}
       <svg xmlns="http://www.w3.org/2000/svg" in:fly={{duration: 500, y: 100}} width="1em" height="1em" viewBox="0 0 24 24"><path fill="currentColor" d="M19.9 2.307a.483.483 0 0 0-.9 0l-.43 1.095a.484.484 0 0 1-.272.274l-1.091.432a.486.486 0 0 0 0 .903l1.091.432a.48.48 0 0 1 .272.273L19 6.81c.162.41.74.41.9 0l.43-1.095a.484.484 0 0 1 .273-.273l1.091-.432a.486.486 0 0 0 0-.903l-1.091-.432a.484.484 0 0 1-.273-.274zM16.033 8.13a.483.483 0 0 0-.9 0l-.157.399a.484.484 0 0 1-.272.273l-.398.158a.486.486 0 0 0 0 .903l.398.157c.125.05.223.148.272.274l.157.399c.161.41.739.41.9 0l.157-.4a.484.484 0 0 1 .272-.273l.398-.157a.486.486 0 0 0 0-.903l-.398-.158a.484.484 0 0 1-.272-.273z"/><path fill="currentColor" d="M12 22c5.523 0 10-4.477 10-10c0-.463-.694-.54-.933-.143a6.5 6.5 0 1 1-8.924-8.924C12.54 2.693 12.463 2 12 2C6.477 2 2 6.477 2 12s4.477 10 10 10"/></svg>
    {:else}
      <svg xmlns="http://www.w3.org/2000/svg"  in:fly={{duration: 500, y: -100}} width="1em" height="1em" viewBox="0 0 128 128"><path fill="#fcc21b" d="M64 30.34c-18.59 0-33.66 15.07-33.66 33.65c0 18.59 15.07 33.66 33.66 33.66c18.59 0 33.66-15.07 33.66-33.66c0-18.58-15.07-33.65-33.66-33.65m-7.24-6.13h14.49c.67 0 1.29-.33 1.68-.88c.38-.54.47-1.25.24-1.88L65.92 1.83C65.62 1.02 64.86.49 64 .49s-1.62.54-1.92 1.34l-7.25 19.63c-.23.63-.14 1.33.24 1.88c.39.55 1.02.87 1.69.87m40.5 16.78c.38.39.91.6 1.44.6c.12 0 .24-.01.36-.03c.66-.12 1.21-.55 1.5-1.16l8.76-19.01c.36-.78.19-1.69-.41-2.3c-.61-.61-1.53-.77-2.31-.42l-19 8.77c-.61.28-1.04.84-1.16 1.5c-.12.66.1 1.33.56 1.81zm28.92 21.09l-19.64-7.24c-.63-.23-1.33-.14-1.88.24c-.55.38-.87 1-.87 1.67l.01 14.49c0 .67.33 1.3.88 1.68c.35.23.76.36 1.17.36c.24 0 .48-.04.71-.13l19.64-7.24c.8-.29 1.34-1.06 1.34-1.93c-.02-.84-.55-1.6-1.36-1.9M100.56 87.6a2.05 2.05 0 0 0-1.5-1.16c-.66-.11-1.34.1-1.8.57L87.01 97.26c-.47.47-.69 1.15-.57 1.81c.12.65.55 1.22 1.16 1.5l19.01 8.76c.27.13.56.18.86.18c.53 0 1.05-.21 1.44-.6c.61-.61.77-1.52.41-2.3zm-29.32 16.18l-14.49.01c-.67 0-1.29.33-1.67.88c-.38.55-.47 1.25-.25 1.87l7.25 19.64c.3.8 1.06 1.34 1.92 1.34s1.62-.54 1.92-1.34l7.25-19.64c.23-.63.14-1.33-.24-1.88c-.39-.55-1.01-.88-1.69-.88m-40.5-16.77c-.47-.47-1.14-.68-1.8-.57c-.66.12-1.22.55-1.5 1.16l-8.76 19.01c-.36.78-.19 1.7.42 2.3a2.038 2.038 0 0 0 2.3.41l19.01-8.77a2.05 2.05 0 0 0 1.16-1.5c.12-.66-.1-1.33-.57-1.8zm-8.57-13.72c.41 0 .82-.13 1.17-.37c.55-.38.88-1.01.88-1.68l-.01-14.49a2.045 2.045 0 0 0-2.75-1.92L1.82 62.08a2.045 2.045 0 0 0 0 3.84l19.65 7.24c.23.09.46.13.7.13m5.28-32.89a2.05 2.05 0 0 0 3.31.59L41 30.74c.47-.48.68-1.15.56-1.81c-.12-.65-.55-1.21-1.16-1.49l-19.02-8.76c-.78-.36-1.69-.19-2.3.42c-.61.61-.77 1.52-.41 2.3z"/></svg>
    {/if}
  </button>
  {#if $open}
    <div
      use:melt={$content}
      transition:fade={{ duration: 300 }}
      class=" z-10 rounded-lg bg-white shadow"
    >
      <div use:melt={$arrow} />
      <p class="px-4 py-1 text-magnum-700">{darkMode ? 'light mode' : 'dark mode' }</p>
    </div>
  {/if}
</div>